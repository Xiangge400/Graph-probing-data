# Graph-probing-data
Graph probing data generated by method from paper PROBING NEURAL TOPOLOGY OF LARGE LANGUAGE MODELS

# Directory structure
```bash
.
├── mmlu # mmlu数据集对应的神经拓扑图，按科目区分
│   ├── disputes 
│   │   └── all_layers # 对模型所有层的神经拓扑图做平均
│   │       └── all_layers_avg_corr.npy # 对所有本科目的题目做平均
│   ├── elementary_mathematics
│   │   └── all_layers
│   │       └── all_layers_avg_corr.npy
│   ├── high_school_macroeconomics
│   │   └── all_layers
│   │       └── all_layers_avg_corr.npy
│   ├── miscellaneous
│   │   └── all_layers
│   │       └── all_layers_avg_corr.npy
│   └── psychology
│       └── all_layers
│           └── all_layers_avg_corr.npy
├── openwebtext # openwebtext通用数据集对应的神经拓扑图
│   ├── all_layers # 对模型所有层的神经拓扑图做平均
│   │   ├── average_100 # 对前100条数据得到的平均图做平均
│   │   │   └── all_layers_avg_corr.npy
│   │   ├── average_100_random_init # 使用随机初始化的模型对前100条数据得到的平均图做平均，用于验证预训练的效果
│   │   │   └── all_layers_avg_corr.npy
│   │   └── partitioned_100 # 将前100条数据均分为3份，每份内做平均，得到局部图
│   │       ├── all_layers_avg_corr_part1.npy
│   │       ├── all_layers_avg_corr_part2.npy
│   │       └── all_layers_avg_corr_part3.npy
│   └── layer12 # 只计算模型第12层的数据
│       ├── average_100 # 对前100条数据得到的平均图做平均
│       │   └── layer_12_avg_corr_openwebtext-100.npy
│       ├── partitioned_100 # 将前100条数据均分为3份，每份内做平均，得到局部图
│       │   ├── layer_12_avg_corr_part1.npy
│       │   ├── layer_12_avg_corr_part2.npy
│       │   └── layer_12_avg_corr_part3.npy
│       ├── partitioned_10000 # 将10000数据均分为3份，每份内做平均，得到局部图
│       │   ├── layer_12_avg_corr_part1.npy
│       │   ├── layer_12_avg_corr_part2.npy
│       │   └── layer_12_avg_corr_part3.npy
│       └── single_example
│           └── layer_12_avg_corr_openwebtext-1.npy # 单独一个例子对应的神经拓扑图
└── README.md
```

# Description:
本仓库存放使用Graph Probing方法得到的模型神经拓扑图。
神经拓扑图是一种用于表征大语言模型内部神经元功能连通性的 n*n维对称矩阵，其中n为隐藏层维度。其构建始于模型对特定语句的处理过程：模型逐 token 解析句子时，每个神经元会产生一个随 token 变化的激活值序列。通过计算任意两个神经元激活序列之间的皮尔逊相关系数，动态的激活模式将被转化为静态的、反映神经元间功能关联的标量度量。具体来说，第i，第j个神经元激活序列的皮尔逊相关系数即为神经拓扑图A中第i行，第j列的元素aij。
现有数据为Qwen2.5-0.5B-base模型在openwebtext-10k以及MMLU数据集上生成的神经拓扑图。具体代码实现请参考仓库：https://github.com/DavyMorgan/llm-graph-probing/tree/main
使用方法：
```python
import numpy as np
data_path = "xxx"
data = np.load(data_path) # numpy.ndarray格式
```

# Reference:
Shen et al. (2025). Probing Neural Topology of Large Language Models. 
arXiv:2506.01042. https://arxiv.org/abs/2506.01042
